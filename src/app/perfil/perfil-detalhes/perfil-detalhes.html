<!-- Seção de Campos Adicionais -->
<div class="mb-6">
  @if (carregando) {
    <app-loading message="Carregando informações do perfil..."></app-loading>
  } @else {
    <h3 class="text-lg font-semibold text-gray-800">Informações da Igreja</h3>
    <p class="mb-4 text-sm text-gray-600">Mantenha suas informações atualizadas</p>

    <!-- Igreja -->
    <div class="mb-4">
      <label class="block text-sm font-medium text-gray-700 mb-2">
        Prédio / Igreja
        @if (editando) {
          <span class="text-red-500">*</span>
        }
      </label>
      @if (!editando) {
        <div class="w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-700">
          {{ perfil.igreja || 'Não informado' }}
        </div>
      } @else {
        <select 
          [(ngModel)]="perfil.igreja"
          (change)="atualizarPastoresPorIgreja(perfil.igreja)"
          name="igreja"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="">Selecione uma opção</option>
          <option *ngFor="let igreja of (igrejas$ | async)" [value]="igreja">
            {{ igreja }}
          </option>
        </select>
      }
    </div>

    <!-- Função -->
    <div class="mb-4">
      <label class="block text-sm font-medium text-gray-700 mb-2">
        Função
        @if (editando) {
          <span class="text-red-500">*</span>
        }
      </label>
      @if (!editando) {
        <div class="w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-700">
          {{ perfil.funcao || 'Não informado' }}
        </div>
      } @else {
        <select 
          [(ngModel)]="perfil.funcao"
          name="funcao"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="">Selecione uma opção</option>
          <option *ngFor="let funcao of (funcoes$ | async)" [value]="funcao">
            {{ funcao }}
          </option>
        </select>
      }
    </div>

    <!-- Pastor de Rede -->
    <div class="mb-4">
      <label class="block text-sm font-medium text-gray-700 mb-2">
        Pastor de Rede
        @if (editando) {
          <span class="text-red-500">*</span>
        }
      </label>
      @if (!editando) {
        <div class="w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg text-gray-700">
          {{ perfil.pastor || 'Não informado' }}
        </div>
      } @else {
        <select 
          [(ngModel)]="perfil.pastor"
          name="pastor"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="">Selecione uma opção</option>
          <option *ngFor="let pastor of (pastores$ | async)" [value]="pastor">
            {{ pastor }}
          </option>
        </select>
      }
    </div>
  }
</div>

<!-- Botões de Ação -->
<div class="flex gap-3">
  @if (!editando) {
    @if (validarPerfil()) {
        <button
          class="w-full border border-gray-300 text-text-muted-light font-bold py-3 px-4 rounded-lg hover:opacity-90 transition shadow-md"
          (click)="iniciarEdicao()">
          Editar Informações
        </button>
    } @else {
        <button
          class="w-full gradient-bg text-white font-bold py-3 px-4 rounded-lg hover:opacity-90 transition shadow-md"
          (click)="iniciarEdicao()">
          Editar Informações
        </button>
    }
  } @else {
    <button
      class="flex-1 border border-gray-300 text-text-muted-light font-bold py-3 px-4 rounded-lg hover:opacity-90 transition shadow-md"
      (click)="cancelarEdicao()">
      Cancelar
    </button>
    <button
      class="flex-1 bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition shadow-md disabled:opacity-50"
      (click)="salvarPerfil()"
      [disabled]="salvando">
      {{ salvando ? 'Salvando...' : 'Salvar' }}
    </button>
  }
</div>
